\section{Discussion}
In this article, we introduce the R package \texttt{BHAM} to fit Bayesian Hierarchical additive models with two-part spike-and-slab LASSO prior. Specifically, \texttt{BHAM} provides a flexible and scalable solution to fit high-dimensional generalized additive model and additive Cox model for continuous, discrete and time-to-event outcomes. To help users to familiarize \texttt{BHAM}, we demonstrate the analytic pipeline in this manuscript. We illustrate additive model construction for high-dimensional data, model fitting and tuning, signal selection and visualization, and new data prediction. Our demonstrating analytic pipeline for binary outcomes can be easily translate to other outcomes by using different options in the functions. We recommend readers to visit our interactive website\url{https://boyiguo1.github.io/BHAM/} for more examples.

Our R package \texttt{BHAM} is versatile and can be widely applied in large-scale molecular and clinical data analyses to model complex signals and provide improved prediction accuracy. Compared to the "black-box" machine learning methods, the additive models provide more interpretable inference of underlying signals, for example using simple visual presentations. In addition, \texttt{BHAM} uniquely offers a bi-level selection approach to detect if underlying signals are linear or nonlinear. This signal detection procedure is a natural product of the two-part spike-and-slab LASSO prior and requires no further thresholding or hypothesis testing. This feature also grants flexibility and automation to our models to relieve users from a priori assumptions on underlying signals. In other words, users do not have to go through any laborious tests for signals shape before fitting a model. \texttt{BHAM} also innovates the computation aspect of high-dimensional Bayesian additive model. It is widely known that fitting high-dimensional Bayeisan models are computationally, particularly when approximation algorithms are used. We provide an economic solution by integrate coordinate descent algorithm with the EM procedure. Our implementation leverages some commonly used modeling interface form the standard R packages, for example \texttt{glmnet} for coordinate descent algorithm, and hence guarantees robustness. Lastly, \texttt{BHAM} allows full customization of additive functions and offers users more flexibility to conduct analyses. We follow the popular additive function syntax in \texttt{mgcv} and provide a parse function to easily produce high-dimensional formula. This level of customization is rarely provided in other high-dimensional additive model packages.

In conclusion, we offer an R package \texttt{BHAM} to provide a flexible and scalable solution to model complex signals for high-dimensional data. We aim to optimize the high-dimensional additive modelling experience by providing friendly analytic pipeline, easy additive function customization and fast algorithms. Our package provides interpretable inference and improved prediction, and hence contribute to prognostic research.




 
